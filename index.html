<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Verilog Plusargs : Verilog Plusargs" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Verilog Plusargs</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/cziesler">View on GitHub</a>

          <h1 id="project_title">Verilog Plusargs</h1>
          <h2 id="project_tagline">Verilog Plusargs</h2>

        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>In Verilog, plusargs can be used to change the behavior of a program without recompiling. This can be great if there are a lot of tests to run with the same testbench.</p>

<p>There are two calls for plusargs in Verilog: <code>$test$plusargs</code> and <code>$value$plusargs</code>.</p>

<p>The first call, <code>$test$plusargs("string")</code>, returns a boolean value. If the plusarg given by <code>"string"</code> was passed into the program at runtime, the call returns true. Otherwise, the call returns false.</p>

<p>The second call, <code>$value$plusargs("string=%d", val)</code>, also returns a boolean value depending on if the plusarg given by <code>"string"</code> was passed in. It also will load the register given by <code>val</code> based on the format given by <code>%d</code> in this example. Here is the list of formats available:</p>

<table>
<thead><tr>
<th>Format</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td><code>%b</code></td>
<td>read as binary value</td>
</tr>
<tr>
<td><code>%o</code></td>
<td>read as octal value</td>
</tr>
<tr>
<td><code>%d</code></td>
<td>read as decimal value</td>
</tr>
<tr>
<td><code>%h</code></td>
<td>read as hex value</td>
</tr>
<tr>
<td><code>%e</code></td>
<td>read as real value, exponential format</td>
</tr>
<tr>
<td><code>%f</code></td>
<td>read as real value, decimal format</td>
</tr>
<tr>
<td><code>%g</code></td>
<td>read as real value, shortest format</td>
</tr>
<tr>
<td><code>%s</code></td>
<td>read as character string</td>
</tr>
</tbody>
</table><p>Note that the <code>$value$plusargs</code> call is available since Verilog-2001. Before that, Verilog only supported the <code>$test$plusargs</code> call.</p>

<p>Here's a simple example. Here, the <code>my_port</code> variable is set to <code>1234</code> by default, unless the <code>+port=</code> plusarg is passed in on the command line when running the executable.</p>

<div class="highlight highlight-verilog"><pre><span class="k">module</span> <span class="n">test</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">my_port</span><span class="p">;</span>

<span class="k">initial</span> <span class="k">begin</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="err">$</span><span class="n">value</span><span class="err">$</span><span class="n">plusargs</span><span class="p">(</span><span class="s">"port=%d"</span><span class="p">,</span> <span class="n">my_port</span><span class="p">))</span> <span class="k">begin</span>
    <span class="n">my_port</span> <span class="o">=</span> <span class="mh">32</span><span class="mi">'d1234</span><span class="p">;</span>
  <span class="k">end</span>

  <span class="nb">$display</span><span class="p">(</span><span class="s">"my_port = %-d"</span><span class="p">,</span> <span class="n">my_port</span><span class="p">);</span>

<span class="k">end</span>
<span class="k">endmodule</span>
</pre></div>

<p>Here is the invocation for compiling the file (using VCS):</p>

<pre><code>% vcs +v2k -sverilog test.sv
</code></pre>

<p>And here is the invocation for running said program (again, using VCS):</p>

<pre><code>% simv
my_port = 1234
</code></pre>

<p>Now, when passing in the <code>+port=5678</code> plusarg, here is the invocation and results:</p>

<pre><code>% simv +port=5678
my_port = 5678
</code></pre>

<p>As you can see, no recompilation is necessary.</p>

<p>Now, say that you need to read in an array of plusargs. This might be useful for creating a look-up table of plusargs.</p>

<div class="highlight highlight-verilog"><pre><span class="k">module</span> <span class="n">test2</span><span class="p">;</span>

<span class="c1">// Associative array with default values</span>
<span class="kt">int</span> <span class="n">plusargs</span><span class="p">[</span><span class="k">string</span><span class="p">]</span> <span class="o">=</span> <span class="p">'{</span><span class="s">"a"</span><span class="o">:</span><span class="mh">1</span><span class="p">,</span> <span class="s">"b"</span><span class="o">:</span><span class="mh">2</span><span class="p">,</span> <span class="s">"c"</span><span class="o">:</span><span class="mh">3</span><span class="p">};</span>

<span class="k">initial</span> <span class="k">begin</span>

  <span class="n">get_plusarg</span><span class="p">(</span><span class="s">"a"</span><span class="p">);</span>
  <span class="n">get_plusarg</span><span class="p">(</span><span class="s">"b"</span><span class="p">);</span>
  <span class="n">get_plusarg</span><span class="p">(</span><span class="s">"c"</span><span class="p">);</span>

  <span class="n">foreach</span> <span class="p">(</span><span class="n">plusargs</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="k">begin</span>
    <span class="nb">$display</span><span class="p">(</span><span class="s">"plusargs[%s] = %-d"</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">plusargs</span><span class="p">[</span><span class="n">s</span><span class="p">]);</span>
  <span class="k">end</span>

<span class="k">end</span>

<span class="k">function</span> <span class="k">void</span> <span class="n">get_plusarg</span><span class="p">(</span><span class="k">string</span> <span class="n">name</span><span class="p">);</span>
  <span class="err">$</span><span class="n">value</span><span class="err">$</span><span class="n">plusargs</span><span class="p">({</span><span class="n">name</span><span class="p">,</span> <span class="s">"=%d"</span><span class="p">},</span> <span class="n">plusargs</span><span class="p">[</span><span class="n">name</span><span class="p">]);</span>
<span class="k">endfunction</span>

<span class="k">endmodule</span>
</pre></div>

<p>We can compile with the following:</p>

<pre><code>% vcs +v2k -sverilog test2.sv
</code></pre>

<p>And run with the following:</p>

<pre><code>% simv
plusargs[a] = 1
plusargs[b] = 2
plusargs[c] = 3
</code></pre>

<p>With plusargs:</p>

<pre><code>% simv +a=12 +b=15
plusargs[a] = 12
plusargs[b] = 15
plusargs[c] = 3
</code></pre>

<p>References:</p>

<ul>
<li><a href="http://stackoverflow.com/questions/16361272/passing-string-variables-to-plusargs-in-system-verilog">http://stackoverflow.com/questions/16361272/passing-string-variables-to-plusargs-in-system-verilog</a></li>
<li><a href="http://www.sutherland-hdl.com/papers/2002-DesignCon-tutorial_using_Verilog-2001_part2.pdf">http://www.sutherland-hdl.com/papers/2002-DesignCon-tutorial_using_Verilog-2001_part2.pdf</a></li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-46520210-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
